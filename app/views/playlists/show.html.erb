<div id="player"></div>


<div class="playlist-banner" style="background-image: url("<%= @playlist.image_url %>");">
  <header class="header">
    <h1 class="header__title" style="color:#1B1B1B;"><span style="background-image: <%= COLORS[@playlist.color] %>;border-radius:20px;padding:0px 20px;"><%= @playlist.name %></span></h1>
    <% @playlist.genres.each do |genre|%>
      <h2> <%= genre.name %> </h2>
    <% end %>
    <h2><%= @playlist.danceability %></h2>
  </header>
</div>


<div class="main">
  <table class="table table-sm table-genres">
    <thead>
      <tr>
        <th scope="col" class="sort" data-sort="title">Title</th>
        <th scope="col" class="sort desc" data-sort="artist">Album</th>

      </tr>
    </thead>
    <tbody class="list">

        <% @playlist.tracks.each_with_index do |x,i|%>
          <tr>
            <th scope="row" class="title">
              <div class="track-image" data-spotify-id="<%= x.spotify_track_id %>" data-img-url="<%= x.image_url %>" data-position="<%= i %>">
              <span><%= i + 1%>.</span>
              <% if x.image_url %>
                <%= image_tag x.image_url %>
              <% else %>
                <%= image_tag 'moods-logo.png' %>
              <% end %>
              <%= x.title %>
              </div>
            </th>
            <td class="artist"><%= x.album %></td>
          </tr>
        <%end%>
      </tbody>
    </table>
  </div>

    <div class="row playlist-items">
      <% if @playlist.image_url %>
        <div class="col-3 image-playlist">
          <%= image_tag @playlist.image_url %>
        </div>
        <div class="col-12 col-md-9">
          <div class="playlist-container">
            <iframe id="spotify-player-iframe" src="https://open.spotify.com/embed/playlist/<%= @playlist.spotify_id %>" <iframe src="https://open.spotify.com/embed/album/1DFixLWuPkv3KT3TnV35m3" width="293" height="373" frameborder="0" allowtransparency="true" allow="encrypted-media" style="width: 100%;" data-spotify-token="<%= current_user.token %>" data-spotify-refresh-token="<%= current_user.refresh_token %>" data-playlist-tracks="<%= @track_ids.to_json%>"></iframe>
          </div>
        </div>
      <% else %>
        <div class="col-12">
          <div class="playlist-container">
            <iframe id="spotify-player-iframe" src="https://open.spotify.com/embed/playlist/<%= @playlist.spotify_id %>" <iframe src="https://open.spotify.com/embed/album/1DFixLWuPkv3KT3TnV35m3" width="293" height="373" frameborder="0" allowtransparency="true" allow="encrypted-media" style="width: 100%;" data-spotify-token="<%= current_user.token %>" data-spotify-refresh-token="<%= current_user.refresh_token %>" data-playlist-tracks="<%= @track_ids.to_json%>"></iframe>
          </div>
        </div>
      <% end %>

    <div class="row">
      <div class="col text-center">
        <span><%= link_to "Edit playlist", edit_playlist_path(@playlist) %></span>
        <span><%= link_to "Refresh", playlist_refresh_path(@playlist) %></span>
        <%#= link_to 'play', root_path, id:'play-btn', class: 'btn btn-primary' %>
      </div>
    </div>
  </div>

</div>

<script src="https://sdk.scdn.co/spotify-player.js"></script>

<%= render 'shared/footer'%>
